<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>K's Tawa - Online Ordering</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #fff8f0;
      color: #333;
    }
    header, footer {
      background: #d35400;
      color: white;
      padding: 15px;
      text-align: center;
    }
    .menu {
      padding: 20px;
    }
    .item {
      display: flex;
      justify-content: space-between;
      background: #fff;
      margin-bottom: 10px;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .cart-button {
      background: #27ae60;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    #checkoutModal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
    }
  </style>
</head>
<body>

<header>
  <h1>K's Tawa - Menu</h1>
</header>

<div class="menu">
  <div class="item">
    <span>Paneer Tikka</span>
    <button class="cart-button" onclick="addToCart('Paneer Tikka', 180)">Add ‚Çπ180</button>
  </div>
  <div class="item">
    <span>Butter Naan</span>
    <button class="cart-button" onclick="addToCart('Butter Naan', 40)">Add ‚Çπ40</button>
  </div>
  <div class="item">
    <span>Dal Makhani</span>
    <button class="cart-button" onclick="addToCart('Dal Makhani', 160)">Add ‚Çπ160</button>
  </div>
</div>

<footer>
  <button class="cart-button" onclick="showCheckoutForm()">üõí Checkout (<span id="cartCount">0</span>)</button>
</footer>

<!-- Checkout Modal -->
<div id="checkoutModal">
  <div class="modal-content">
    <h2>Enter Your Details</h2>
    <input type="text" id="customerName" placeholder="Name" style="width:100%;margin-bottom:10px;padding:8px" />
    <input type="tel" id="customerPhone" placeholder="Phone Number" style="width:100%;margin-bottom:10px;padding:8px" />
    <div style="margin-top:10px;">
      <button onclick="submitOrder()" class="cart-button">Submit Order</button>
      <button onclick="document.getElementById('checkoutModal').style.display='none'" class="cart-button" style="background:#c0392b;margin-left:10px;">Cancel</button>
    </div>
  </div>
</div>

<script>
let cart = [];

function addToCart(name, price) {
  cart.push({ name, price });
  document.getElementById("cartCount").innerText = cart.length;
}

function showCheckoutForm() {
  if (cart.length === 0) {
    alert("Cart is empty!");
    return;
  }
  document.getElementById("checkoutModal").style.display = "flex";
}

function submitOrder() {
  const name = document.getElementById("customerName").value.trim();
  const phone = document.getElementById("customerPhone").value.trim();

  if (!name || !phone) {
    alert("Please fill in your name and phone.");
    return;
  }

  fetch("https://orede-receive.onrender.com/orders", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name, phone, items: cart })
  })
  .then(async res => {
    if (!res.ok) {
      const text = await res.text();
      throw new Error(`Server error: ${res.status} - ${text}`);
    }
    return res.json();
  })
  .then(data => {
    alert("‚úÖ Order placed!");
    cart = [];
    document.getElementById("cartCount").innerText = 0;
    document.getElementById("checkoutModal").style.display = "none";
  })
  .catch(err => {
    console.error("Error placing final order:", err);
    alert("‚ùå Could not place order. Please try again.");
  });
}
</script>

</body>
</html>
